(function(){"use strict";var R=(n=>(n[n.NOTHING=0]="NOTHING",n[n.TRY_THINKING=1]="TRY_THINKING",n[n.EASY_NAKED_SINGLE=2]="EASY_NAKED_SINGLE",n[n.NAKED_SINGLE=3]="NAKED_SINGLE",n[n.BOARD_FINISHED=4]="BOARD_FINISHED",n))(R||{});let h=Date.now(),d=0;const S=()=>{const n=Date.now();return d++,d>=4&&n-h<5e3?(d=0,[]):(h=n,null)},g=(n,t,o)=>{const r=o%9,I=Math.floor(o/9);for(let e=0;e<9;e++){const c=I*9+e,l=r+e*9;if(c!==o&&n[c]===t||l!==o&&n[l]===t)return!1}const f=Math.floor(I/3)*3,a=Math.floor(r/3)*3,s=f+3,i=a+3;for(let e=f;e<s;e++)for(let c=a;c<i;c++){const l=e*9+c;if(l!==o&&n[l]===t)return!1}return!0},N=(n,t,o,r)=>{for(let e=0;e<9;e++){const c=r*9+e,l=o+e*9;if(c!==r&&n[c]===t||l!==o&&n[l]===t)return!1}const I=Math.floor(r/3)*3,f=Math.floor(o/3)*3,a=I+3,s=f+3,i=r*9+o;for(let e=I;e<a;e++)for(let c=f;c<s;c++){const l=e*9+c;if(l!==i&&n[l]===t)return!1}return!0},C=n=>{for(let t=0;t<n.length;t++){if(n[t]!==null)continue;const o=t%9,r=Math.floor(t/9),I=[1,2,3,4,5,6,7,8,9],f=[];n:for(;I.length;){const s=I.pop(),i=Math.floor(r/3)*3,e=Math.floor(o/3)*3,c=i+3,l=e+3;for(let u=i;u<c;u++)for(let w=e;w<l;w++){const E=u*9+w;if(E!==t&&n[E]===s)continue n}f.push(s)}const a=new Set;for(let s=0;s<9;s++){const i=o+s*9;if(n[i]===null)for(const e of f)N(n,e,s,r)||a.add(e)}if(f.filter(a.has,a).length===1)return[{col:o,row:r}];a.clear();for(let s=0;s<9;s++){const i=r*9+s;if(n[i]===null)for(const e of f)N(n,e,o,s)||a.add(e)}if(f.filter(a.has,a).length===1)return[{col:o,row:r}]}return null},M=n=>{for(let t=0;t<n.length;t++){if(n[t]!==null)continue;const o=t%9,r=Math.floor(t/9),I=[1,2,3,4,5,6,7,8,9],f=[];n:for(;I.length;){const a=I.pop();for(let l=0;l<9;l++){const u=r*9+l,w=o+l*9;if(u!==t&&n[u]===a||w!==t&&n[w]===a)continue n}const s=Math.floor(r/3)*3,i=Math.floor(o/3)*3,e=s+3,c=i+3;for(let l=s;l<e;l++)for(let u=i;u<c;u++){const w=l*9+u;if(w!==t&&n[w]===a)continue n}f.push(a)}if(f.length===1)return[{col:o,row:r}]}return null},x=n=>{for(let t=0;t<n.length;t++){const o=n[t];if(o===null||!g(n,o,t))return null}return[]},m={[1]:S,[2]:C,[3]:M,[4]:x},A=({data:{cells:n}})=>{const t=Object.keys(R).map(o=>parseInt(o,10)).filter(o=>!Number.isNaN(o));for(const o of t){if(o===0)continue;const r=m[o](n);if(r)return{type:o,cells:r}}return{type:0,cells:[]}};onmessage=({data:{cells:n}})=>{const t=A({data:{cells:n}});postMessage(JSON.stringify(t))}})();
