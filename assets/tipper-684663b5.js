(function(){"use strict";var d=(n=>(n[n.NOTHING=0]="NOTHING",n[n.TRY_THINKING=1]="TRY_THINKING",n[n.MISTAKE=2]="MISTAKE",n[n.EASY_NAKED_SINGLE=3]="EASY_NAKED_SINGLE",n[n.NAKED_SINGLE=4]="NAKED_SINGLE",n[n.BOARD_FINISHED=5]="BOARD_FINISHED",n))(d||{});let h=Date.now(),R=0;const S=()=>{const n=Date.now();return R++,R>=4&&n-h<5e3?(R=0,[]):(h=n,null)},g=n=>{const t=new Map;for(let o=0;o<9;o++){t.clear();for(let e=0;e<9;e++){const r=o+e*9;if(n[r]!==null){if(t.has(n[r]))return[t.get(n[r]),{col:o,row:e}];t.set(n[r],{col:o,row:e})}}}for(let o=0;o<9;o++){t.clear();for(let e=0;e<9;e++){const r=e+o*9;if(n[r]!==null){if(t.has(n[r]))return[t.get(n[r]),{col:e,row:o}];t.set(n[r],{col:e,row:o})}}}for(let o=0;o<9;o+=3)for(let e=0;e<9;e+=3){t.clear();for(let r=0;r<3;r++)for(let f=0;f<3;f++){const c=o+r,s=e+f,i=c+s*9;if(n[i]!==null){if(t.has(n[i]))return[t.get(n[i]),{col:c,row:s}];t.set(n[i],{col:c,row:s})}}}return null},C=(n,t,o)=>{const e=o%9,r=Math.floor(o/9);for(let l=0;l<9;l++){const u=r*9+l,a=e+l*9;if(u!==o&&n[u]===t||a!==o&&n[a]===t)return!1}const f=Math.floor(r/3)*3,c=Math.floor(e/3)*3,s=f+3,i=c+3;for(let l=f;l<s;l++)for(let u=c;u<i;u++){const a=l*9+u;if(a!==o&&n[a]===t)return!1}return!0},N=(n,t,o,e)=>{for(let l=0;l<9;l++){const u=e*9+l,a=o+l*9;if(u!==e&&n[u]===t||a!==o&&n[a]===t)return!1}const r=Math.floor(e/3)*3,f=Math.floor(o/3)*3,c=r+3,s=f+3,i=e*9+o;for(let l=r;l<c;l++)for(let u=f;u<s;u++){const a=l*9+u;if(a!==i&&n[a]===t)return!1}return!0},M=n=>{for(let t=0;t<n.length;t++){if(n[t]!==null)continue;const o=t%9,e=Math.floor(t/9),r=[1,2,3,4,5,6,7,8,9],f=[];n:for(;r.length;){const s=r.pop(),i=Math.floor(e/3)*3,l=Math.floor(o/3)*3,u=i+3,a=l+3;for(let I=i;I<u;I++)for(let w=l;w<a;w++){const E=I*9+w;if(E!==t&&n[E]===s)continue n}f.push(s)}const c=new Set;for(let s=0;s<9;s++){const i=o+s*9;if(n[i]===null)for(const l of f)N(n,l,s,e)||c.add(l)}if(f.filter(c.has,c).length===1)return[{col:o,row:e}];c.clear();for(let s=0;s<9;s++){const i=e*9+s;if(n[i]===null)for(const l of f)N(n,l,o,s)||c.add(l)}if(f.filter(c.has,c).length===1)return[{col:o,row:e}]}return null},m=n=>{for(let t=0;t<n.length;t++){if(n[t]!==null)continue;const o=t%9,e=Math.floor(t/9),r=[1,2,3,4,5,6,7,8,9],f=[];n:for(;r.length;){const c=r.pop();for(let a=0;a<9;a++){const I=e*9+a,w=o+a*9;if(I!==t&&n[I]===c||w!==t&&n[w]===c)continue n}const s=Math.floor(e/3)*3,i=Math.floor(o/3)*3,l=s+3,u=i+3;for(let a=s;a<l;a++)for(let I=i;I<u;I++){const w=a*9+I;if(w!==t&&n[w]===c)continue n}f.push(c)}if(f.length===1)return[{col:o,row:e}]}return null},x=n=>{for(let t=0;t<n.length;t++){const o=n[t];if(o===null||!C(n,o,t))return null}return[]},A={[1]:S,[2]:g,[3]:M,[4]:m,[5]:x},D=({data:{cells:n}})=>{const t=Object.keys(d).map(o=>parseInt(o,10)).filter(o=>!Number.isNaN(o));for(const o of t){if(o===0)continue;const e=A[o](n);if(e)return{type:o,cells:e}}return{type:0,cells:[]}};onmessage=({data:{cells:n}})=>{const t=D({data:{cells:n}});postMessage(JSON.stringify(t))}})();
